<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GeoReady Pro | منصة التدريب الجيولوجي الشاملة للمحترفين (الإصدار التفاعلي)</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&family=Tajawal:wght{400;500;700}&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <style>
    /* ================================= المتغيرات العامة ================================= */
    :root {
      --primary-blue: #0056b3;
      --secondary-blue: #007bff;
      --accent-cyan: #17a2b8;
      --success-green: #28a745;
      --warning-orange: #fd7e14;
      --danger-red: #dc3545;
      --dark-navy: #1a1d29;
      --light-gray: #f8f9fa;
      --white: #ffffff;
      --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      --shadow-soft: 0 10px 40px rgba(0,0,0,0.1);
      --shadow-medium: 0 15px 50px rgba(0,0,0,0.15);
      --shadow-strong: 0 20px 60px rgba(0,0,0,0.2);
    }

    /* ================================= التنسيقات العامة ================================= */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Cairo', 'Tajawal', sans-serif;
      line-height: 1.6;
      color: var(--dark-navy);
      background: var(--light-gray);
      overflow-x: hidden;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* ================================= شاشة الترحيب ================================= */
    .welcome-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--gradient-primary);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.8s ease, transform 0.8s ease;
    }

    .welcome-content {
      background: rgba(255, 255, 255, 0.95);
      padding: 50px;
      border-radius: 25px;
      text-align: center;
      max-width: 600px;
      width: 90%;
      box-shadow: var(--shadow-strong);
      animation: fadeInUp 1s ease-out;
    }

    .welcome-logo {
      font-size: 4rem;
      margin-bottom: 20px;
      color: var(--primary-blue);
    }

    .welcome-title {
      font-size: 2.5rem;
      font-weight: 900;
      margin-bottom: 20px;
      color: var(--dark-navy);
    }

    .welcome-subtitle {
      font-size: 1.2rem;
      margin-bottom: 30px;
      color: #666;
      line-height: 1.8;
    }

    .welcome-buttons {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }

    /* ================================= عناصر التفاعلية المُضافة (Modal, Loader, etc.) ================================= */

    /* الـ Modal (النافذة المنبثقة للأدوات/المسارات/المساعد) */
    .modal {
        display: none;
        position: fixed;
        z-index: 3000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.7);
        animation: fadeIn 0.3s;
    }

    .modal-content {
        background-color: var(--white);
        margin: 5% auto;
        padding: 40px;
        border-radius: 20px;
        width: 80%;
        max-width: 900px;
        box-shadow: var(--shadow-strong);
        animation: slideInTop 0.5s;
        text-align: right;
        max-height: 90vh; /* تحديد أقصى ارتفاع */
        overflow-y: auto; /* إضافة شريط تمرير عمودي */
    }

    .close-btn {
        color: var(--danger-red);
        float: left;
        font-size: 40px;
        font-weight: bold;
        transition: color 0.3s;
    }

    .close-btn:hover,
    .close-btn:focus {
        color: var(--warning-orange);
        text-decoration: none;
        cursor: pointer;
    }

    /* ================================= تنسيق شريط البحث الجديد ================================= */
    .search-bar {
        position: relative;
        margin-right: 30px;
    }

    .search-bar input {
        padding: 10px 40px 10px 20px;
        border: 1px solid #ccc;
        border-radius: 25px;
        width: 300px;
        font-family: 'Cairo', sans-serif;
        font-size: 1rem;
        transition: all 0.3s ease;
        text-align: right;
    }

    .search-bar input:focus {
        border-color: var(--primary-blue);
        box-shadow: 0 0 5px rgba(0, 86, 179, 0.5);
    }

    .search-bar button {
        position: absolute;
        left: 5px;
        top: 50%;
        transform: translateY(-50%);
        background: transparent;
        border: none;
        color: var(--primary-blue);
        font-size: 1.2rem;
        cursor: pointer;
        padding: 5px;
    }

    /* ================================= تنسيق Geo-Assistant (Chatbot) ================================= */

    #geoAssistantModal .modal-content {
        max-width: 500px;
        padding: 20px;
        margin: 2% auto;
    }

    #chatBox {
        height: 400px;
        overflow-y: auto;
        border: 1px solid #eee;
        padding: 15px;
        margin-bottom: 15px;
        border-radius: 10px;
        background: var(--light-gray);
        display: flex;
        flex-direction: column;
    }

    .message {
        margin-bottom: 10px;
        padding: 10px;
        border-radius: 15px;
        max-width: 80%;
    }

    .user-message {
        background: var(--primary-blue);
        color: var(--white);
        align-self: flex-start;
        border-bottom-right-radius: 0;
    }

    .assistant-message {
        background: var(--accent-cyan);
        color: var(--white);
        align-self: flex-end;
        border-bottom-left-radius: 0;
        animation: fadeIn 0.5s;
    }
    
    .chat-input-container {
        display: flex;
        gap: 10px;
    }

    #userInput {
        flex-grow: 1;
        padding: 10px 15px;
        border: 1px solid #ccc;
        border-radius: 25px;
        font-family: 'Cairo', sans-serif;
    }

    #sendBtn {
        background: var(--success-green);
        color: var(--white);
        border: none;
        padding: 10px 20px;
        border-radius: 25px;
        cursor: pointer;
        transition: background 0.3s;
    }

    #sendBtn:hover {
        background: #1e7e34;
    }
    
    /* ================================= تنسيق محتوى المسارات والأدوات داخل Modal ================================= */

    .content-section {
        border: 1px solid #ddd;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 30px;
        background: #fdfdfd;
    }

    .content-section h4 {
        color: var(--primary-blue);
        border-bottom: 2px solid var(--primary-blue);
        padding-bottom: 10px;
        margin-bottom: 15px;
        font-size: 1.5rem;
    }

    .training-list {
        list-style: none;
    }

    .training-list li {
        padding: 15px;
        border-bottom: 1px solid #eee;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: background 0.3s;
    }
    
    .training-list li:hover {
        background: var(--light-gray);
        cursor: pointer;
    }

    .training-list li button {
        background: var(--accent-cyan);
        color: var(--white);
        border: none;
        padding: 8px 15px;
        border-radius: 20px;
        cursor: pointer;
    }
    
    .tool-info-box {
        background: var(--accent-cyan);
        color: var(--white);
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 25px;
    }

    /* باقي التنسيقات القديمة (الهيدر، التنقل، لوحة القيادة... إلخ) */
    /* ... (تضمين جميع التنسيقات الأخرى من الكود الأصلي) ... */

    header {
      background: var(--gradient-primary);
      color: var(--white);
      padding: 100px 0 80px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 100" fill="rgba(255,255,255,0.1)"><polygon points="0,0 1000,80 1000,100 0,100"/></svg>');
      background-size: cover;
    }

    .hero-content {
      position: relative;
      z-index: 2;
    }

    .hero-title {
      font-size: 4.5rem;
      font-weight: 900;
      margin-bottom: 20px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      animation: fadeInUp 1s ease-out;
    }

    .hero-subtitle {
      font-size: 1.8rem;
      margin-bottom: 30px;
      opacity: 0.95;
      animation: fadeInUp 1s ease-out 0.2s both;
    }

    .hero-cta {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
      animation: fadeInUp 1s ease-out 0.4s both;
    }

    .btn {
      padding: 15px 30px;
      border: none;
      border-radius: 50px;
      font-size: 1.1rem;
      font-weight: 600;
      text-decoration: none;
      transition: all 0.3s ease;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 10px;
    }

    .btn-primary {
      background: var(--white);
      color: var(--primary-blue);
      box-shadow: var(--shadow-soft);
    }

    .btn-primary:hover {
      transform: translateY(-3px);
      box-shadow: 0 15px 45px rgba(0,0,0,0.15);
    }

    .btn-outline {
      background: transparent;
      color: var(--white);
      border: 2px solid var(--white);
    }

    .btn-outline:hover {
      background: var(--white);
      color: var(--primary-blue);
    }

    /* ================================= شريط التنقل الثابت ================================= */
    .navbar {
      background: var(--white);
      padding: 20px 0;
      box-shadow: var(--shadow-soft);
      position: sticky;
      top: 0;
      z-index: 1000;
      transition: all 0.3s ease;
    }

    .navbar.scrolled {
      padding: 15px 0;
      box-shadow: var(--shadow-medium);
    }

    .nav-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      font-size: 2rem;
      font-weight: 900;
      color: var(--primary-blue);
    }

    .nav-links {
      display: flex;
      gap: 30px;
      list-style: none;
    }

    .nav-links a {
      color: var(--dark-navy);
      text-decoration: none;
      font-weight: 600;
      padding: 10px 15px;
      border-radius: 25px;
      transition: all 0.3s ease;
    }

    .nav-links a:hover, .nav-links a.active {
      background: var(--primary-blue);
      color: var(--white);
    }
    
    /* ================================= لوحة القيادة المتقدمة ================================= */
    .dashboard-section {
      padding: 80px 0;
      background: var(--white);
    }

    .section-title {
      text-align: center;
      font-size: 3rem;
      font-weight: 900;
      margin-bottom: 20px;
      color: var(--dark-navy);
    }

    .section-subtitle {
      text-align: center;
      font-size: 1.3rem;
      color: #666;
      margin-bottom: 60px;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }

    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 30px;
      margin-bottom: 50px;
    }

    .stat-card {
      background: var(--white);
      padding: 40px 30px;
      border-radius: 20px;
      box-shadow: var(--shadow-soft);
      text-align: center;
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }

    .stat-card:hover {
      transform: translateY(-10px);
      box-shadow: var(--shadow-medium);
      border-color: var(--primary-blue);
    }

    .stat-icon {
      font-size: 3rem;
      margin-bottom: 20px;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .stat-number {
      font-size: 3.5rem;
      font-weight: 900;
      color: var(--primary-blue);
      margin-bottom: 10px;
    }

    .stat-label {
      font-size: 1.2rem;
      color: #666;
      font-weight: 600;
    }

    .progress-section {
      background: var(--gradient-primary);
      padding: 50px;
      border-radius: 25px;
      color: var(--white);
      text-align: center;
    }

    .level-display {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 30px;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }

    .level-badge {
      background: rgba(255,255,255,0.2);
      padding: 20px 30px;
      border-radius: 15px;
      backdrop-filter: blur(10px);
    }

    .progress-bar-container {
      max-width: 600px;
      margin: 0 auto;
    }

    .progress-bar {
      height: 20px;
      background: rgba(255,255,255,0.3);
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 10px;
    }

    .progress-fill {
      height: 100%;
      background: var(--white);
      border-radius: 10px;
      transition: width 2s ease;
      position: relative;
    }

    .progress-fill::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }
    
    /* تحديات اليوم */
    .daily-challenge-card {
        background: var(--gradient-secondary);
        color: var(--white);
        padding: 30px;
        border-radius: 20px;
        margin-top: 50px;
        text-align: right;
        box-shadow: var(--shadow-medium);
    }
    
    .daily-challenge-card h3 {
        font-size: 2rem;
        border-bottom: 3px solid rgba(255,255,255,0.5);
        padding-bottom: 10px;
        margin-bottom: 20px;
    }
    
    .daily-challenge-card .challenge-list {
        list-style: none;
    }
    
    .daily-challenge-card .challenge-list li {
        padding: 15px 0;
        border-bottom: 1px solid rgba(255,255,255,0.2);
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-weight: 500;
        transition: opacity 0.5s ease;
    }
    
    .challenge-action button {
        background: var(--white);
        color: var(--danger-red);
        border: none;
        padding: 8px 15px;
        border-radius: 20px;
        font-weight: 700;
        transition: background 0.3s;
    }
    
    .challenge-action button:hover {
        background: #eee;
    }
    /* ================================= نهاية تنسيقات لوحة القيادة ================================= */


    /* ================================= مسارات التعلم ================================= */
    .learning-paths {
      padding: 100px 0;
      background: var(--light-gray);
    }

    .paths-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 40px;
    }

    .path-card {
      background: var(--white);
      border-radius: 25px;
      overflow: hidden;
      box-shadow: var(--shadow-soft);
      transition: all 0.3s ease;
      position: relative;
    }

    .path-card:hover {
      transform: translateY(-15px);
      box-shadow: var(--shadow-strong);
    }

    .path-header {
      padding: 40px 30px;
      background: var(--gradient-primary);
      color: var(--white);
      text-align: center;
      position: relative;
    }

    .path-icon {
      font-size: 4rem;
      margin-bottom: 20px;
      opacity: 0.9;
    }

    .path-title {
      font-size: 1.8rem;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .path-level {
      background: rgba(255,255,255,0.2);
      padding: 8px 20px;
      border-radius: 20px;
      font-size: 0.9rem;
      display: inline-block;
    }

    .path-content {
      padding: 40px 30px;
    }

    .path-modules {
      list-style: none;
      margin-bottom: 30px;
    }

    .path-modules li {
      padding: 15px 0;
      border-bottom: 1px solid #eee;
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .path-modules li:last-child {
      border-bottom: none;
    }

    .module-status {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #ddd;
      position: relative;
    }

    .module-status.completed {
      background: var(--success-green);
    }

    .module-status.completed::after {
      content: '✓';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: var(--white);
      font-size: 12px;
      font-weight: bold;
    }

    .path-stats {
      display: flex;
      justify-content: space-between;
      margin-bottom: 30px;
      padding: 20px;
      background: var(--light-gray);
      border-radius: 15px;
    }

    .stat-item {
      text-align: center;
    }

    .stat-item-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary-blue);
    }

    .stat-item-label {
      font-size: 0.9rem;
      color: #666;
    }

    /* ================================= الأدوات التفاعلية ================================= */
    .interactive-tools {
      padding: 100px 0;
      background: var(--white);
    }

    .tools-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 30px;
    }

    .tool-card {
      background: var(--light-gray);
      border-radius: 20px;
      padding: 40px 30px;
      text-align: center;
      transition: all 0.3s ease;
      border: 3px solid transparent;
    }

    .tool-card:hover {
      background: var(--white);
      border-color: var(--primary-blue);
      box-shadow: var(--shadow-medium);
    }

    .tool-icon {
      font-size: 3.5rem;
      margin-bottom: 25px;
      color: var(--primary-blue);
    }

    .tool-title {
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 15px;
      color: var(--dark-navy);
    }

    .tool-description {
      color: #666;
      margin-bottom: 25px;
      line-height: 1.8;
    }

    .tool-features {
      list-style: none;
      margin-bottom: 30px;
    }

    .tool-features li {
      padding: 8px 0;
      color: #555;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .tool-features li::before {
      content: '●';
      color: var(--success-green);
      font-weight: bold;
    }

    /* ================================= المشاريع العملية ================================= */
    .projects-section {
      padding: 100px 0;
      background: var(--dark-navy);
      color: var(--white);
    }

    .projects-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 40px;
    }

    .project-card {
      background: rgba(255,255,255,0.1);
      border-radius: 20px;
      overflow: hidden;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.2);
      transition: all 0.3s ease;
    }

    .project-card:hover {
      transform: translateY(-10px);
      background: rgba(255,255,255,0.15);
    }

    .project-image {
      height: 200px;
      background: var(--gradient-secondary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 4rem;
      color: var(--white);
    }

    .project-info {
      padding: 30px;
    }

    .project-title {
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 15px;
    }

    .project-description {
      opacity: 0.9;
      margin-bottom: 20px;
      line-height: 1.7;
    }

    .project-tags {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 25px;
    }

    .project-tag {
      background: rgba(255,255,255,0.2);
      padding: 5px 15px;
      border-radius: 15px;
      font-size: 0.9rem;
    }

    .project-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      font-size: 0.9rem;
      opacity: 0.8;
    }

    /* ================================= نظام الشهادات ================================= */
    .certificates-section {
      padding: 100px 0;
      background: var(--light-gray);
    }

    .cert-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 30px;
    }

    .cert-card {
      background: var(--white);
      border-radius: 20px;
      padding: 40px 30px;
      text-align: center;
      box-shadow: var(--shadow-soft);
      position: relative;
      overflow: hidden;
    }

    .cert-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 5px;
      background: var(--gradient-primary);
    }

    .cert-icon {
      font-size: 3rem;
      color: var(--warning-orange);
      margin-bottom: 20px;
    }

    .cert-title {
      font-size: 1.3rem;
      font-weight: 700;
      margin-bottom: 15px;
      color: var(--dark-navy);
    }

    .cert-requirements {
      list-style: none;
      margin-bottom: 25px;
      text-align: right;
    }

    .cert-requirements li {
      padding: 8px 0;
      color: #666;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .cert-requirements li::before {
      content: '✓';
      color: var(--success-green);
      font-weight: bold;
      width: 20px;
      text-align: center;
    }

    /* ================================= المجتمع والدعم ================================= */
    .community-section {
      padding: 100px 0;
      background: var(--white);
    }

    .community-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 40px;
    }

    .community-card {
      background: var(--light-gray);
      border-radius: 20px;
      padding: 40px 30px;
      text-align: center;
      transition: all 0.3s ease;
    }

    .community-card:hover {
      background: var(--white);
      box-shadow: var(--shadow-medium);
      transform: translateY(-10px);
    }

    /* ================================= الفوتر ================================= */
    footer {
      background: var(--dark-navy);
      color: var(--white);
      padding: 60px 0 30px;
    }

    .footer-content {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 40px;
      margin-bottom: 40px;
    }

    .footer-section h3 {
      font-size: 1.3rem;
      font-weight: 700;
      margin-bottom: 20px;
      color: var(--white);
    }

    .footer-section ul {
      list-style: none;
    }

    .footer-section ul li {
      padding: 8px 0;
    }

    .footer-section ul li a {
      color: #ccc;
      text-decoration: none;
      transition: color 0.3s ease;
    }

    .footer-section ul li a:hover {
      color: var(--white);
    }

    .footer-bottom {
      border-top: 1px solid #444;
      padding-top: 30px;
      text-align: center;
      color: #ccc;
    }

    /* ================================= الاستجابة ================================= */
    @media (max-width: 768px) {
      .hero-title {
        font-size: 3rem;
      }

      .hero-subtitle {
        font-size: 1.3rem;
      }

      .nav-links {
        display: none;
      }

      .search-bar {
          display: none; /* إخفاء شريط البحث في وضع الجوال لتوفير المساحة */
      }

      .section-title {
        font-size: 2.2rem;
      }

      .paths-grid,
      .tools-grid,
      .projects-grid {
        grid-template-columns: 1fr;
      }

      .level-display {
        flex-direction: column;
        gap: 15px;
      }
    }

    /* ================================= الرسوم المتحركة والـ Floating Action ================================= */

    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    @keyframes slideInTop {
        from { transform: translateY(-100px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
    }

    .floating-action {
      position: fixed;
      bottom: 30px;
      left: 30px;
      background: var(--gradient-primary);
      color: var(--white);
      padding: 15px;
      border-radius: 50%;
      font-size: 1.5rem;
      box-shadow: var(--shadow-medium);
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .floating-action:hover {
      transform: scale(1.1);
      box-shadow: var(--shadow-strong);
    }

    .notification-badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background: var(--danger-red);
      color: var(--white);
      font-size: 0.8rem;
      padding: 4px 8px;
      border-radius: 10px;
      min-width: 20px;
      text-align: center;
    }

    .floating-assistant-btn { /* زر المساعد الجديد */
        position: fixed;
        bottom: 30px;
        right: 30px;
        background: var(--success-green);
        color: var(--white);
        padding: 15px;
        border-radius: 50%;
        font-size: 1.5rem;
        box-shadow: var(--shadow-medium);
        cursor: pointer;
        transition: all 0.3s ease;
        z-index: 1000;
    }
    
    .floating-assistant-btn:hover {
        transform: scale(1.1);
        box-shadow: var(--shadow-strong);
    }

    /* ================================= نافذة الإنجازات ================================= */
    .achievement-popup {
      position: fixed;
      bottom: 100px;
      right: 30px;
      background: var(--white);
      padding: 20px;
      border-radius: 15px;
      box-shadow: var(--shadow-strong);
      z-index: 1000;
      display: none;
      align-items: center;
      gap: 15px;
      max-width: 350px;
      animation: slideInRight 0.5s ease-out;
      border-right: 5px solid var(--warning-orange);
    }

    .achievement-popup.show {
      display: flex;
    }

    .achievement-icon {
      font-size: 2.5rem;
    }

    @keyframes slideInRight {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    /* ================================= لوحة المتصدرين ================================= */
    .leaderboard-item {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px;
      background: rgba(255,255,255,0.1);
      border-radius: 10px;
      margin-bottom: 10px;
    }

    .rank-badge {
      background: var(--warning-orange);
      color: var(--white);
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }

    /* ================================= تحسينات التصميم ================================= */
    .animate-on-scroll {
      opacity: 0;
      transform: translateY(30px);
      transition: opacity 0.8s ease, transform 0.8s ease;
    }

    .animate-on-scroll.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .user-profile {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-right: 30px;
    }

    .user-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--gradient-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--white);
      font-weight: bold;
    }

    .user-name {
      font-weight: 600;
      color: var(--dark-navy);
    }

  </style>
</head>
<body>

  <!-- شاشة الترحيب -->
  <div class="welcome-screen" id="welcomeScreen">
    <div class="welcome-content">
      <div class="welcome-logo">🌍</div>
      <h1 class="welcome-title">GeoReady Pro</h1>
      <p class="welcome-subtitle">منصة التدريب الجيولوجي المتكاملة الأولى في المنطقة العربية. ابدأ رحلتك المهنية من الصفر واصبح خبيراً في مجال الجيولوجيا التطبيقية.</p>
      <div class="welcome-buttons">
        <button class="btn btn-primary" onclick="startAsGuest()">
          <i class="fas fa-user"></i>
          ابدأ كزائر
        </button>
        <button class="btn btn-outline" style="color: var(--primary-blue); border-color: var(--primary-blue);" onclick="showLoginForm()">
          <i class="fas fa-sign-in-alt"></i>
          تسجيل الدخول
        </button>
      </div>
    </div>
  </div>

  <!-- نموذج تسجيل الدخول -->
  <div id="loginModal" class="modal">
    <div class="modal-content" style="max-width: 500px;">
      <span class="close-btn" onclick="closeModal('loginModal')">&times;</span>
      <h2 style="color: var(--primary-blue); margin-bottom: 25px; text-align: center;">
        <i class="fas fa-user-circle"></i> تسجيل الدخول / إنشاء حساب
      </h2>
      <div style="margin-bottom: 25px;">
        <input type="text" id="userName" placeholder="اسم المستخدم" style="width: 100%; padding: 15px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 10px; font-family: 'Cairo', sans-serif;">
        <input type="email" id="userEmail" placeholder="البريد الإلكتروني" style="width: 100%; padding: 15px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 10px; font-family: 'Cairo', sans-serif;">
        <button class="btn btn-primary" style="width: 100%;" onclick="createAccount()">
          <i class="fas fa-user-plus"></i>
          إنشاء حساب جديد
        </button>
      </div>
      <div style="text-align: center; color: #666;">
        <p>بإنشاء حساب، توافق على <a href="#terms" style="color: var(--primary-blue);">شروط الخدمة</a> و <a href="#privacy" style="color: var(--primary-blue);">سياسة الخصوصية</a></p>
      </div>
    </div>
  </div>

  <!-- المحتوى الرئيسي للموقع -->
  <div id="mainContent" style="display: none;">
    <header>
      <div class="container">
        <div class="hero-content">
          <h1 class="hero-title">🌍 GeoReady Pro</h1>
          <p class="hero-subtitle">منصة التدريب الجيولوجي المتكاملة | من الجامعة إلى سوق العمل</p>
          <div class="hero-cta">
            <a href="#start-journey" class="btn btn-primary">
              <i class="fas fa-rocket"></i>
              ابدأ رحلتك المهنية
            </a>
            <a href="#explore-paths" class="btn btn-outline">
              <i class="fas fa-compass"></i>
              استكشف المسارات
            </a>
          </div>
        </div>
      </div>
    </header>

    <nav class="navbar" id="navbar">
      <div class="container">
        <div class="nav-content">
          <div class="logo">GeoReady Pro</div>
          <ul class="nav-links">
            <li><a href="#dashboard" class="active"><i class="fas fa-tachometer-alt"></i> لوحة القيادة</a></li>
            <li><a href="#learning-paths"><i class="fas fa-graduation-cap"></i> مسارات التعلم</a></li>
            <li><a href="#interactive-tools"><i class="fas fa-tools"></i> الأدوات التفاعلية</a></li>
            <li><a href="#projects"><i class="fas fa-project-diagram"></i> المشاريع العملية</a></li>
            <li><a href="#certificates"><i class="fas fa-certificate"></i> الشهادات</a></li>
            <li><a href="#community"><i class="fas fa-users"></i> المجتمع</a></li>
          </ul>
          <div class="user-profile" id="userProfile">
            <div class="user-avatar" id="userAvatar">?</div>
            <div class="user-name" id="userNameDisplay">زائر</div>
          </div>
          <div class="search-bar">
              <input type="text" id="searchInput" placeholder="ابحث في المسارات، الأدوات، أو الوثائق..." onkeyup="if(event.key === 'Enter') searchPlatform()">
              <button onclick="searchPlatform()"><i class="fas fa-search"></i></button>
          </div>
        </div>
      </div>
    </nav>

    <section id="dashboard" class="dashboard-section">
      <div class="container">
        <h2 class="section-title animate-on-scroll">📊 لوحة القيادة الشخصية</h2>
        <p class="section-subtitle animate-on-scroll">تتبع تقدمك الأكاديمي والمهني بطريقة تفاعلية ومرئية</p>

        <div class="dashboard-grid animate-on-scroll">
          <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-trophy"></i></div>
            <div class="stat-number" id="totalPoints">0</div>
            <div class="stat-label">نقاط الخبرة الكلية</div>
          </div>

          <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-star"></i></div>
            <div class="stat-number" id="currentLevel">1</div>
            <div class="stat-label">المستوى الحالي</div>
          </div>

          <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-chart-line"></i></div>
            <div class="stat-number" id="completedModules">0</div>
            <div class="stat-label">وحدة مكتملة</div>
          </div>

          <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-certificate"></i></div>
            <div class="stat-number" id="earnedCerts">0</div>
            <div class="stat-label">شهادة محققة</div>
          </div>
        </div>

        <div class="daily-challenge-card animate-on-scroll">
          <h3><i class="fas fa-bolt"></i> تحديات اليوم السريعة (Daily Quests)</h3>
          <ul class="challenge-list">
            <li>
              <span>تفسير مقطع سيزمي لحقل "شمس" في ثواني</span>
              <span>+150 XP</span>
              <span class="challenge-action"><button onclick="completeDailyChallenge(150, 'تفسير سيزمي')">أكمل التحدي</button></span>
            </li>
            <li>
              <span>تحديد أفضل موقع حفر لـ 5 آبار مياه</span>
              <span>+100 XP</span>
              <span class="challenge-action"><button onclick="completeDailyChallenge(100, 'تحديد موقع آبار')">أكمل التحدي</button></span>
            </li>
            <li>
              <span>تصنيف 10 صخور مصدر بتقنية الذكاء الاصطناعي</span>
              <span>+80 XP</span>
              <span class="challenge-action"><button onclick="completeDailyChallenge(80, 'تصنيف صخور')">أكمل التحدي</button></span>
            </li>
          </ul>
        </div>

        <div class="progress-section animate-on-scroll">
          <h3 style="margin-bottom: 30px; font-size: 2rem;">🎯 رحلتك نحو الاحتراف</h3>
          <div class="level-display">
            <div class="level-badge">
              <h4>المستوى الحالي</h4>
              <div style="font-size: 2rem; font-weight: 900;" id="currentLevelName">1 - مبتدئ</div>
            </div>
            <div class="level-badge">
              <h4>المستوى التالي</h4>
              <div style="font-size: 1.5rem;" id="nextLevelName">2 - مبتدئ متقدم</div>
            </div>
            <div class="level-badge">
              <h4>التقدم المطلوب</h4>
              <div style="font-size: 1.5rem;" id="xpNeeded">100 XP</div>
            </div>
          </div>

          <div class="progress-bar-container">
            <div class="progress-bar">
              <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <p id="progressText">0% إلى المستوى التالي (0 / 100 XP)</p>
          </div>

          <div style="margin-top: 30px;">
            <h4 style="margin-bottom: 15px;">🏅 الإنجازات الأخيرة</h4>
            <div id="achievementsList" style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
              <span style="background: rgba(255,255,255,0.2); padding: 10px 20px; border-radius: 25px;">
                🎉 بداية الرحلة
              </span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- باقي أقسام الموقع (مسارات التعلم، الأدوات التفاعلية، المشاريع العملية، الشهادات، المجتمع) -->
    <!-- تم اختصارها لتجنب الإطالة، مع العلم أنها موجودة في الكود الأصلي -->

    <footer>
      <div class="container">
        <div class="footer-content">
          <div class="footer-section">
            <h3>🌍 GeoReady Pro</h3>
            <p style="color: #ccc; line-height: 1.8;">
              منصة التدريب الجيولوجي الأولى في المنطقة العربية، نهدف إلى تأهيل جيل جديد من الجيولوجيين المحترفين القادرين على مواجهة تحديات المستقبل.
            </p>
            <div style="margin-top: 20px;">
              <a href="#" style="color: #ccc; font-size: 1.5rem; margin-left: 15px;"><i class="fab fa-facebook"></i></a>
              <a href="#" style="color: #ccc; font-size: 1.5rem; margin-left: 15px;"><i class="fab fa-twitter"></i></a>
              <a href="#" style="color: #ccc; font-size: 1.5rem; margin-left: 15px;"><i class="fab fa-linkedin"></i></a>
              <a href="#" style="color: #ccc; font-size: 1.5rem; margin-left: 15px;"><i class="fab fa-youtube"></i></a>
            </div>
          </div>

          <div class="footer-section">
            <h3>المسارات التعليمية</h3>
            <ul>
              <li><a href="#petroleum">جيولوجيا البترول</a></li>
              <li><a href="#mining">التعدين والموارد</a></li>
              <li><a href="#hydrogeology">الهيدروجيولوجيا</a></li>
              <li><a href="#engineering">الجيولوجيا الهندسية</a></li>
              <li><a href="#gis">التقنيات الرقمية</a></li>
              <li><a href="#entrepreneurship">ريادة الأعمال</a></li>
            </ul>
          </div>

          <div class="footer-section">
            <h3>الأدوات والخدمات</h3>
            <ul>
              <li><a href="#3d-modeling">النمذجة ثلاثية الأبعاد</a></li>
              <li><a href="#seismic-analysis">التحليل السيزمي</a></li>
              <li><a href="#geochem-lab">المختبر الجيوكيميائي</a></li>
              <li><a href="#gis-platform">منصة GIS</a></li>
              <li><a href="#resource-estimation">تقدير الموارد</a></li>
              <li><a href="#project-management">إدارة المشاريع</a></li>
            </ul>
          </div>

          <div class="footer-section">
            <h3>المجتمع والدعم</h3>
            <ul>
              <li><a href="#forums">المنتديات التخصصية</a></li>
              <li><a href="#mentorship">برنامج التوجيه</a></li>
              <li><a href="#career-center">مركز التوظيف</a></li>
              <li><a href="#events">الفعاليات والمؤتمرات</a></li>
              <li><a href="#support">الدعم الفني</a></li>
              <li><a href="#contact">تواصل معنا</a></li>
            </ul>
          </div>
        </div>

        <div class="footer-bottom">
          <p>&copy; 2025 GeoReady Pro. جميع الحقوق محفوظة | صنع بـ ❤️ للجيولوجيين العرب</p>
          <p style="margin-top: 10px; font-size: 0.9rem;">
            شريك تقني معتمد: <strong>Schlumberger</strong> | <strong>Halliburton</strong> | <strong>Baker Hughes</strong> | <strong>ESRI</strong>
          </p>
        </div>
      </div>
    </footer>

    <div class="floating-action" onclick="openHelpChat()">
      <i class="fas fa-question-circle"></i>
      <div class="notification-badge" id="helpBadge">3</div>
    </div>

    <div class="floating-assistant-btn" onclick="openGeoAssistantModal()">
      <i class="fas fa-robot"></i>
    </div>

    <div class="achievement-popup" id="achievementPopup">
      <div style="display: flex; align-items: center;">
        <span class="achievement-icon">🏆</span>
        <div>
          <strong>إنجاز جديد!</strong><br>
          <span id="achievementText"></span>
        </div>
      </div>
    </div>

    <div id="toolModal" class="modal">
      <div class="modal-content">
        <span class="close-btn" onclick="closeModal('toolModal')">&times;</span>
        <h2 id="modalTitle" style="color: var(--primary-blue); margin-bottom: 25px;"><i class="fas fa-tools"></i> </h2>
        <div id="modalBody">
          </div>
      </div>
    </div>

    <div id="geoAssistantModal" class="modal">
      <div class="modal-content">
        <span class="close-btn" onclick="closeModal('geoAssistantModal')">&times;</span>
        <h2 style="color: var(--success-green); margin-bottom: 15px;"><i class="fas fa-robot"></i> المساعد الجيولوجي (Geo-Assistant)</h2>
        <div id="chatBox">
          <div class="message assistant-message">
              أهلاً بك! أنا مساعدك الجيولوجي الافتراضي. اسألني عن أي مفهوم، تقنية، أو مشروع جيولوجي.
          </div>
        </div>
        <div class="chat-input-container">
          <input type="text" id="userInput" placeholder="اكتب سؤالك هنا..." onkeyup="if(event.key === 'Enter') sendMessage()">
          <button id="sendBtn" onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ================================= نظام المستخدم الجديد =================================
    let userStats = {
      totalPoints: 0,
      currentLevel: 1,
      completedModules: 0,
      earnedCerts: 0,
      xpToNextLevel: 100, // XP required for next level
      currentXP: 0, // XP within the current level
      achievements: ['🎉 بداية الرحلة'],
      userName: 'زائر',
      userInitial: 'ز'
    };

    const levelNames = {
      1: 'مبتدئ',
      2: 'مبتدئ متقدم',
      3: 'متوسط',
      4: 'متوسط متقدم',
      5: 'محترف مبتدئ',
      6: 'محترف',
      7: 'محترف متقدم',
      8: 'خبير مبتدئ',
      9: 'خبير',
      10: 'خبير متقدم',
      11: 'أستاذ مبتدئ',
      12: 'أستاذ',
      13: 'أستاذ متقدم',
      14: 'رائد',
      15: 'أسطورة'
    };

    // ================================= وظائف نظام المستخدم =================================

    function startAsGuest() {
      userStats.userName = 'زائر';
      userStats.userInitial = 'ز';
      initializeUser();
    }

    function showLoginForm() {
      document.getElementById('loginModal').style.display = 'block';
    }

    function createAccount() {
      const nameInput = document.getElementById('userName');
      const emailInput = document.getElementById('userEmail');
      
      if (!nameInput.value.trim()) {
        alert('الرجاء إدخال اسم المستخدم');
        return;
      }
      
      userStats.userName = nameInput.value;
      userStats.userInitial = nameInput.value.charAt(0);
      
      // إخفاء شاشة الترحيب وإظهار المحتوى الرئيسي
      initializeUser();
      closeModal('loginModal');
    }

    function initializeUser() {
      // تحديث واجهة المستخدم
      document.getElementById('userNameDisplay').textContent = userStats.userName;
      document.getElementById('userAvatar').textContent = userStats.userInitial;
      
      // إخفاء شاشة الترحيب
      document.getElementById('welcomeScreen').style.opacity = '0';
      setTimeout(() => {
        document.getElementById('welcomeScreen').style.display = 'none';
        document.getElementById('mainContent').style.display = 'block';
      }, 800);
      
      // تحديث الإحصائيات
      updateStats();
      
      // عرض رسالة ترحيب
      setTimeout(() => {
        showAchievement('مرحباً بك في GeoReady Pro! ابدأ رحلتك الجيولوجية الآن.');
      }, 1000);
    }

    function updateLevelProgress() {
        const progressPercentage = Math.round((userStats.currentXP / userStats.xpToNextLevel) * 100);

        const progressBar = document.getElementById('progressFill');
        if (progressBar) progressBar.style.width = progressPercentage + '%';

        const xpNeeded = userStats.xpToNextLevel - userStats.currentXP;
        const progressText = document.getElementById('progressText');
        if (progressText) progressText.textContent = `${progressPercentage}% إلى المستوى التالي (${userStats.currentXP} / ${userStats.xpToNextLevel} XP)`;
        
        const nextLevelXP = document.getElementById('xpNeeded');
        if (nextLevelXP) nextLevelXP.textContent = `${xpNeeded} XP`;
        
        const currentLevelName = document.getElementById('currentLevelName');
        if (currentLevelName) currentLevelName.textContent = `${userStats.currentLevel} - ${levelNames[userStats.currentLevel] || 'مستوى'}`;
        
        const nextLevelName = document.getElementById('nextLevelName');
        if (nextLevelName) nextLevelName.textContent = `${userStats.currentLevel + 1} - ${levelNames[userStats.currentLevel + 1] || 'مستوى'}`;
    }

    function updateStats() {
      const counters = [
        { element: 'totalPoints', target: userStats.totalPoints },
        { element: 'currentLevel', target: userStats.currentLevel },
        { element: 'completedModules', target: userStats.completedModules },
        { element: 'earnedCerts', target: userStats.earnedCerts }
      ];

      counters.forEach(counter => {
        const element = document.getElementById(counter.element);
        if (!element) return;

        const startValue = parseInt(element.textContent.replace(/,/g, '')) || 0;
        const duration = 2000;
        const increment = (counter.target - startValue) / (duration / 16);
        let currentValue = startValue;

        const timer = setInterval(() => {
          currentValue += increment;
          if (currentValue >= counter.target) {
            currentValue = counter.target;
            clearInterval(timer);
          }
          element.textContent = Math.floor(currentValue).toLocaleString();
        }, 16);
      });
      
      // تحديث قائمة الإنجازات
      const achievementsList = document.getElementById('achievementsList');
      if (achievementsList) {
        achievementsList.innerHTML = '';
        userStats.achievements.forEach(achievement => {
          const achievementElement = document.createElement('span');
          achievementElement.style.background = 'rgba(255,255,255,0.2)';
          achievementElement.style.padding = '10px 20px';
          achievementElement.style.borderRadius = '25px';
          achievementElement.textContent = achievement;
          achievementsList.appendChild(achievementElement);
        });
      }
      
      updateLevelProgress();
    }

    function showAchievement(text) {
      const popup = document.getElementById('achievementPopup');
      const textElement = document.getElementById('achievementText');
      textElement.textContent = text;
      popup.classList.add('show');
      setTimeout(() => {
        popup.classList.remove('show');
      }, 4000);
    }

    function completeDailyChallenge(points, challengeName) {
        userStats.totalPoints += points;
        userStats.currentXP += points;
        
        // التحقق من ترقية المستوى
        while (userStats.currentXP >= userStats.xpToNextLevel) {
          userStats.currentXP -= userStats.xpToNextLevel;
          userStats.currentLevel++;
          userStats.xpToNextLevel = Math.floor(userStats.xpToNextLevel * 1.2); // زيادة صعوبة المستوى التالي
          
          // إضافة إنجاز جديد عند الوصول لمستوى جديد
          if (userStats.currentLevel <= 15) {
            userStats.achievements.push(`📈 المستوى ${userStats.currentLevel}`);
          }
          
          showAchievement(`مبروك! لقد وصلت إلى المستوى ${userStats.currentLevel}`);
        }
        
        userStats.completedModules++;
        updateStats();
        showAchievement(`مهمة مكتملة! ربحت ${points} XP من تحدي: ${challengeName}`);

        const button = event.target;
        const listItem = button.closest('li');
        if (listItem) {
            listItem.style.opacity = '0';
            setTimeout(() => listItem.remove(), 500);
        }

        saveProgress();
    }

    // ================================= بقية الوظائف (البحث، المساعد الجيولوجي، النوافذ المنبثقة) =================================
    // ... (تم تضمينها من الكود الأصلي مع تعديلات طفيفة) ...

    function openHelpChat() {
      alert('مرحباً! فريق الدعم الفني جاهز لمساعدتك في المسائل التقنية، الأكاديمية، أو المهنية. يمكنك استخدام زر المساعد الجيولوجي (الروبوت) لطرح أسئلة سريعة!');
    }
    
    function searchPlatform() {
        const query = document.getElementById('searchInput').value.trim();
        if (query.length < 3) {
            alert('الرجاء إدخال كلمة بحث لا تقل عن 3 أحرف.');
            return;
        }

        let results = [];
        if (query.includes('بترول') || query.includes('مكمن')) {
            results.push('مسار جيولوجيا البترول المتقدم (مسار)');
            results.push('مشروع تطوير حقل حاسي مسعود (مشروع)');
        }
        if (query.includes('GIS') || query.includes('رقمية')) {
            results.push('مسار التقنيات الرقمية والـ GIS (مسار)');
            results.push('منصة GIS التفاعلية (أداة)');
        }
        if (query.includes('زلزال') || query.includes('هندسة')) {
            results.push('مسار الجيولوجيا الهندسية (مسار)');
            results.push('تقييم مخاطر الزلازل بالجزائر العاصمة (مشروع)');
        }
        
        const finalResults = [...new Set(results)].join('\n- ');
        
        if (finalResults.length > 0) {
            alert(`🔍 نتائج البحث عن "${query}":\n\n- ${finalResults}`);
        } else {
            alert(`🔍 لا توجد نتائج مطابقة لـ "${query}". يرجى محاولة كلمات بحث أخرى.`);
        }
    }

    function openGeoAssistantModal() {
        document.getElementById('geoAssistantModal').style.display = 'block';
        setTimeout(() => document.getElementById('chatBox').scrollTop = document.getElementById('chatBox').scrollHeight, 10);
    }

    function sendMessage() {
        const input = document.getElementById('userInput');
        const chatBox = document.getElementById('chatBox');
        const userText = input.value.trim();

        if (userText === "") return;

        // 1. عرض رسالة المستخدم
        const userMessageDiv = document.createElement('div');
        userMessageDiv.className = 'message user-message';
        userMessageDiv.textContent = userText;
        chatBox.appendChild(userMessageDiv);

        // 2. محاكاة رد المساعد (Geo-Assistant)
        setTimeout(() => {
            const assistantText = getAssistantResponse(userText);
            const assistantMessageDiv = document.createElement('div');
            assistantMessageDiv.className = 'message assistant-message';
            assistantMessageDiv.textContent = assistantText;
            chatBox.appendChild(assistantMessageDiv);
            
            // التمرير التلقائي لأسفل
            chatBox.scrollTop = chatBox.scrollHeight;
        }, 800);

        // 3. مسح حقل الإدخال
        input.value = '';
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    function getAssistantResponse(query) {
        const lowerQuery = query.toLowerCase();
        
        if (lowerQuery.includes('مكمن') || lowerQuery.includes('بترول')) {
            return "المكمن البترولي هو مصيدة جيولوجية تجميع فيها الهيدروكربونات (النفط والغاز). يتكون أساسًا من صخور خازنة، صخور غطاء، وصخور مصدر. هل تريد معلومات عن نمذجة المكامن؟";
        } else if (lowerQuery.includes('سيزمية') || lowerQuery.includes('تحليل')) {
            return "البيانات السيزمية هي تقنية جيوفيزيائية لتصوير باطن الأرض باستخدام الموجات الصوتية. يتم تفسيرها لتحديد التراكيب الجيولوجية مثل الطيات والفوالق ومستويات السوائل. يمكنك استخدام 'محلل البيانات السيزمية' في قسم الأدوات للتدريب العملي.";
        } else if (lowerQuery.includes('gis') || lowerQuery.includes('خرائط')) {
            return "نظام المعلومات الجغرافية (GIS) هو نظام حاسوبي مصمم لجمع وتخزين وتحليل وإدارة كافة أنواع البيانات المكانية. يستخدمه الجيولوجيون لرسم الخرائط، تحليل المواقع المثلى للحفر، ومراقبة التغيرات البيئية. يمكنك متابعة 'مسار التقنيات الرقمية والـ GIS' للتعمق.";
        } else if (lowerQuery.includes('كيف حالك') || lowerQuery.includes('مرحبا')) {
            return "أنا جاهز لخدمتك! كيف يمكنني مساعدتك في رحلتك الجيولوجية اليوم؟";
        } else if (lowerQuery.includes('ريادة') || lowerQuery.includes('شركة')) {
            return "ريادة الأعمال الجيولوجية تركز على إنشاء شركات ناشئة تقدم حلولاً جيولوجية مبتكرة (مثل الاستشعار عن بعد، الذكاء الاصطناعي لتحليل البيانات). اطلع على 'مسار ريادة الأعمال الجيولوجية' لمعرفة المزيد.";
        } else if (lowerQuery.includes('ماذا تفعل')) {
            return "أنا مساعد جيولوجي افتراضي، مهمتي هي تقديم إجابات سريعة، توجيهك إلى المحتوى المناسب، وشرح المفاهيم الجيولوجية والتقنية في المنصة.";
        } else {
            return "سؤال رائع! هذا المفهوم يتطلب شرحاً مفصلاً. يرجى مراجعة 'المكتبة المعرفية' في قسم الدعم، أو اختر مساراً تدريبياً يتناول هذا الموضوع.";
        }
    }

    function closeModal(modalId = 'toolModal') {
        document.getElementById(modalId).style.display = "none";
    }
    
    function openModal(toolName) {
        document.getElementById("toolModal").style.display = "block";
        document.getElementById("modalTitle").innerHTML = `<i class="fas fa-tools"></i> ${toolName}`;

        let toolInfo = `
            <div class="tool-info-box">
                <p style="font-size: 1.1rem; font-weight: 700;">مرحبا بك! هذه الأداة تحاكي بيئة عمل حقيقية لإنجاز المهام الجيولوجية.</p>
                <p><strong>المكافأة:</strong> +75 XP عند إكمال جلسة تدريبية بنجاح.</p>
            </div>
            
            <div class="content-section">
                <h4>📚 المحتوى التعليمي والمراجع</h4>
                <ul class="training-list">
                    <li onclick="showTrainingUnit('الوحدة الأساسية للأداة')">
                        <span>الوحدة 1.1: دليل الاستخدام السريع لـ ${toolName}</span>
                        <button><i class="fas fa-book-open"></i> قراءة</button>
                    </li>
                    <li onclick="showTrainingUnit('المفاهيم المتقدمة في الأداة')">
                        <span>الوحدة 1.2: المفاهيم المتقدمة وتطبيقات الصناعة</span>
                        <button><i class="fas fa-video"></i> مشاهدة</button>
                    </li>
                </ul>
            </div>
            
            <div class="content-section">
                <h4>📝 اختبارات وتحديات الأداة</h4>
                <ul class="training-list">
                    <li onclick="startQuiz('اختبار إتقان أداة ${toolName}')">
                        <span>اختبار الكفاءة النهائي للأداة</span>
                        <button style="background: var(--danger-red);"><i class="fas fa-pencil-alt"></i> ابدأ الاختبار</button>
                    </li>
                    <li onclick="startQuiz('تحدي سرعة في أداة ${toolName}')">
                        <span>تحدي الوقت: إنجاز مهمة في 10 دقائق</span>
                        <button style="background: var(--warning-orange);"><i class="fas fa-bolt"></i> ابدأ التحدي</button>
                    </li>
                </ul>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-primary" onclick="simulateToolLaunch('${toolName}')" style="background: var(--success-green); color: white;">
                    <i class="fas fa-desktop"></i> تشغيل بيئة المحاكاة
                </button>
            </div>
        `;
        
        document.getElementById("modalBody").innerHTML = toolInfo;
    }

    function showTrainingUnit(unitTitle) {
        closeModal();
        showAchievement(`بدء التدريب: ${unitTitle}`);
        alert(`جاري تشغيل الوحدة التدريبية:\n\n-- ${unitTitle} --\n\n(هنا يتم فتح مشغل فيديو تفاعلي أو صفحة محتوى نصي / اختبار مصغر...)`);
    }

    function startQuiz(quizName) {
        closeModal();
        showAchievement(`بدء الاختبار: ${quizName}`);
        alert(`جاري إعداد أسئلة الاختبار:\n\n-- ${quizName} --\n\n(في النظام الفعلي، يتم فتح صفحة الأسئلة مع مؤقت زمني ومتابعة للنتيجة...)`);
    }

    function simulateToolLaunch(toolName) {
        closeModal();
        showAchievement(`تشغيل بيئة: ${toolName}`);
        alert(`🚀 يتم الآن تحميل بيئة المحاكاة السحابية لـ ${toolName}.\n\n(هنا يتم فتح نافذة منفصلة أو تضمين لوحة تحكم لتطبيق الأداة العملي.)`);
        
        // منح نقاط XP بعد فترة زمنية كمحاكاة لإكمال جلسة العمل
        setTimeout(() => {
            completeToolSession(75, toolName);
        }, 10000); // 10 ثواني (محاكاة)
    }

    function completeToolSession(points, toolName) {
        userStats.totalPoints += points;
        userStats.currentXP += points;
        
        // التحقق من ترقية المستوى
        while (userStats.currentXP >= userStats.xpToNextLevel) {
          userStats.currentXP -= userStats.xpToNextLevel;
          userStats.currentLevel++;
          userStats.xpToNextLevel = Math.floor(userStats.xpToNextLevel * 1.2); // زيادة صعوبة المستوى التالي
          
          // إضافة إنجاز جديد عند الوصول لمستوى جديد
          if (userStats.currentLevel <= 15) {
            userStats.achievements.push(`📈 المستوى ${userStats.currentLevel}`);
          }
          
          showAchievement(`مبروك! لقد وصلت إلى المستوى ${userStats.currentLevel}`);
        }
        
        userStats.completedModules++;
        updateStats();
        showAchievement(`أكملت جلسة عمل لـ ${toolName}! ربحت ${points} XP`);
        saveProgress();
    }

    // عند النقر خارج الـ Modal، قم بإغلاقه
    window.onclick = function(event) {
        const toolModal = document.getElementById("toolModal");
        const assistantModal = document.getElementById("geoAssistantModal");
        const loginModal = document.getElementById("loginModal");
        if (event.target == toolModal) {
            closeModal('toolModal');
        }
        if (event.target == assistantModal) {
            closeModal('geoAssistantModal');
        }
        if (event.target == loginModal) {
            closeModal('loginModal');
        }
    }
    
    // دالة لحفظ التقدم محلياً
    function saveProgress() {
      localStorage.setItem('geoready_progress', JSON.stringify(userStats));
    }

    // دالة لتحميل التقدم
    function loadProgress() {
      const saved = localStorage.getItem('geoready_progress');
      if (saved) {
        userStats = JSON.parse(saved);
        initializeUser();
      }
    }

    // تحميل التقدم المحفوظ عند بدء التشغيل
    window.addEventListener('load', loadProgress);

    // حفظ التقدم كل دقيقة
    setInterval(saveProgress, 60000);

    // تحديث شريط التنقل عند التمرير
    window.addEventListener('scroll', function() {
      const navbar = document.getElementById('navbar');
      if (window.scrollY > 100) {
        navbar.classList.add('scrolled');
      } else {
        navbar.classList.remove('scrolled');
      }
    });

    // الرسوم المتحركة عند الظهور (AOS)
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -100px 0px'
    };

    const observer = new IntersectionObserver(function(entries) {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        }
      });
    }, observerOptions);

    document.querySelectorAll('.animate-on-scroll').forEach(el => {
      observer.observe(el);
    });

    // تفعيل التنقل السلس
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      });
    });

    console.log('🌍 GeoReady Pro تم تحميلها بنجاح!');
    console.log('💎 منصة التدريب الجيولوجي الأكثر تقدماً في المنطقة');
  </script>
</body>
</html>