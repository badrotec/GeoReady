<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GeoReady — اختبار جيولوجيا تفاعلي</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <main id="app" class="app" role="application" aria-labelledby="app-title">
    <header class="header">
      <h1 id="app-title">GeoReady — اختبار جيولوجيا</h1>
      <nav class="top-controls" aria-label="تحكم رئيسي">
        <button id="homeBtn" class="btn icon-btn" aria-label="الصفحة الرئيسية">🏠 القائمة الرئيسية</button>
        <button id="resultsBtn" class="btn" aria-label="عرض النتائج">النتائج</button>
        <button id="muteBtn" class="btn icon-btn" aria-label="كتم الصوت">🔊</button>
        <button id="devModeBtn" class="btn" aria-pressed="false" title="وضع المطور (اختبارات)">Dev</button>
      </nav>
    </header>

    <section id="setup" class="card">
      <h2>إعداد الاختبار</h2>
      <div class="form-grid">
        <label>
          بنك الأسئلة:
          <select id="bankSelect" aria-label="اختر بنك الأسئلة">
            <option value="BasicGeology.json">BasicGeology</option>
            <option value="Geochemistry.json">Geochemistry</option>
            <option value="Geophysics.json">Geophysics</option>
            <option value="Hydrogeology.json">Hydrogeology</option>
            <option value="Petrology.json">Petrology</option>
            <option value="Structuralgeology.json">Structuralgeology</option>
            <option value="sedimentarygeology.json">sedimentarygeology</option>
            <option value="ALL">كل الفئات</option>
          </select>
        </label>

        <label>
          عدد الأسئلة:
          <select id="countSelect" aria-label="عدد الأسئلة">
            <option value="10">10</option>
            <option value="20">20</option>
            <option value="25">25</option>
            <option value="ALL">كلها</option>
          </select>
        </label>

        <label>
          وقت السؤال (بالثواني):
          <input id="timePerQuestion" type="number" min="5" max="300" value="20" aria-label="وقت السؤال بالثواني" />
        </label>

        <label>
          عند التخطي:
          <select id="skipBehavior" aria-label="تصرف عند التخطي">
            <option value="unanswered">يُحتسب غير مُجاب (لا صوت)</option>
            <option value="timeout_sound">يُحتسب غير مُجاب وشغّل صوت انتهاء الوقت</option>
          </select>
        </label>

        <label>
          شَفِل عرض الخيارات:
          <input id="shuffleOptions" type="checkbox" checked aria-label="تبديل ترتيب الخيارات" />
        </label>

        <label>
          وضع Dev (اختبار الأصوات):
          <input id="forcePlay" type="checkbox" aria-label="تشغيل الأصوات في وضع التطوير" />
        </label>
      </div>

      <div class="actions">
        <button id="startBtn" class="btn primary" aria-label="ابدأ الاختبار (S)">ابدأ (S)</button>
        <button id="loadBanksBtn" class="btn" aria-label="تحميل بنوك الأسئلة">تحقّق/تحميل بنوك</button>
      </div>

      <div id="setupLog" class="log" aria-live="polite"></div>
    </section>

    <section id="quiz" class="card hidden" aria-live="polite">
      <div class="quiz-header">
        <div id="progressText">السؤال 0 من 0</div>
        <div id="timerWrap">
          <div id="timerText" aria-live="polite">00:00</div>
          <progress id="timerBar" value="0" max="100"></progress>
        </div>
      </div>

      <article id="questionArea" class="question" role="region" aria-labelledby="qText">
        <h3 id="qText">نص السؤال سيظهر هنا</h3>
        <div id="optionsList" class="options" role="list" aria-label="خيارات السؤال">
          <!-- خيارات تُولد ديناميكيًا -->
        </div>
        <div class="controls">
          <button id="prevBtn" class="btn" aria-label="السابق">السابق</button>
          <button id="skipBtn" class="btn" aria-label="تخطي السؤال">تخطي</button>
          <button id="toggleTimerBtn" class="btn" aria-pressed="false" aria-label="إيقاف/استئناف المؤقت">إيقاف/استئناف المؤقت</button>
          <button id="nextBtn" class="btn" aria-label="التالي">التالي</button>
        </div>
      </article>
    </section>

    <section id="results" class="card hidden" aria-live="polite">
      <h2>النتائج</h2>
      <div id="summary"></div>
      <div id="topScores">
        <h3>أفضل 5 نتائج</h3>
        <ol id="scoresList"></ol>
      </div>
      <div class="actions">
        <button id="exportBtn" class="btn" aria-label="تصدير الجلسة">تصدير الجلسة</button>
        <button id="reviewMistakesBtn" class="btn" aria-label="التعلّم من أخطائي">تعلّم من أخطائي</button>
        <button id="backToMenuBtn" class="btn" aria-label="العودة إلى القائمة الرئيسية">رجوع</button>
      </div>
      <div id="mistakesList" class="hidden"></div>
    </section>

    <!-- Modals -->
    <div id="modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal-content">
        <h3 id="modalTitle">تحذير</h3>
        <div id="modalBody"></div>
        <div class="modal-actions">
          <button id="modalPrimary" class="btn primary">حسناً</button>
          <button id="modalSecondary" class="btn">إلغاء</button>
        </div>
      </div>
    </div>

    <footer class="footer">
      <small>GeoReady — واجهة تفاعلية لاختبارات الجيولوجيا • لا تعتمد على باكإند</small>
    </footer>
  </main>

  <script src="script.js" defer></script>
</body>
</html>